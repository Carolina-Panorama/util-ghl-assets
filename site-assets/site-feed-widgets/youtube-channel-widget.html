<!-- YouTube Channel Widget (Grid Layout) -->
<style>
.yt-channel-widget {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0;
}

.yt-channel-header {
  display: flex;
  align-items: center;
  gap: 24px;
  margin-bottom: 32px;
  padding: 24px;
  background: linear-gradient(135deg, #003366 0%, #004d99 100%);
  border-radius: 18px;
  color: #fff;
}

.yt-channel-logo {
  height: 60px;
  width: auto;
  max-width: 120px;
  object-fit: contain;
  flex-shrink: 0;
}

.yt-channel-avatar {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: #e5e7eb;
  flex-shrink: 0;
  object-fit: cover;
  border: 3px solid #dcb349;
}

.yt-channel-info h2 {
  margin: 0 0 8px 0;
  font-size: 1.75rem;
  font-weight: 700;
}

.yt-channel-info p {
  margin: 0;
  font-size: 1rem;
  opacity: 0.95;
}

.yt-channel-subscribe {
  margin-left: auto;
  padding: 12px 28px;
  background: #dcb349;
  color: #003366;
  border: none;
  border-radius: 8px;
  font-weight: 700;
  cursor: pointer;
  transition: background 0.2s, transform 0.15s, box-shadow 0.2s;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-size: 1rem;
  box-shadow: 0 2px 8px rgba(220, 179, 73, 0.3);
}

.yt-channel-subscribe:hover {
  background: #e8c969;
  transform: scale(1.05);
  box-shadow: 0 4px 12px rgba(220, 179, 73, 0.4);
}

.yt-videos-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  gap: 20px;
  padding: 0;
}

.yt-video-card {
  background: #fff;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 2px 12px rgba(0, 51, 102, 0.08);
  transition: box-shadow 0.3s, transform 0.2s, border-color 0.2s;
  cursor: pointer;
  text-decoration: none;
  color: inherit;
  display: flex;
  flex-direction: column;
  border: 2px solid transparent;
}

.yt-video-card:hover {
  box-shadow: 0 8px 24px rgba(0, 51, 102, 0.15);
  transform: translateY(-2px);
  border-color: #dcb349;
}

.yt-video-thumbnail {
  position: relative;
  overflow: hidden;
  background: #e5e7eb;
  aspect-ratio: 16 / 9;
}

.yt-video-thumbnail img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.3s;
}

.yt-video-card:hover .yt-video-thumbnail img {
  transform: scale(1.05);
}

.yt-video-duration {
  position: absolute;
  bottom: 8px;
  right: 8px;
  background: rgba(0,0,0,0.8);
  color: #fff;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 0.85rem;
  font-weight: 600;
}

.yt-video-info {
  padding: 12px 16px;
  flex: 1;
  display: flex;
  flex-direction: column;
}

.yt-video-title {
  font-size: 1rem;
  font-weight: 600;
  color: #003366;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
  margin: 0 0 8px 0;
  line-height: 1.4;
}

.yt-video-meta {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.85rem;
  color: #004d99;
  margin-top: auto;
}

.yt-video-views {
  display: flex;
  align-items: center;
  gap: 4px;
}

.yt-loading {
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 300px;
  font-size: 1.1rem;
  color: #64748b;
}

.yt-loading::after {
  content: '';
  display: inline-block;
  width: 20px;
  height: 20px;
  margin-left: 12px;
  border: 3px solid #e5e7eb;
  border-top-color: #003366;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.yt-error {
  padding: 24px;
  background: #e8f0f8;
  border-left: 4px solid #003366;
  border-radius: 8px;
  color: #003366;
  font-weight: 500;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .yt-channel-header {
    flex-direction: column;
    text-align: center;
  }
  
  .yt-channel-logo {
    height: 50px;
  }
  
  .yt-channel-subscribe {
    margin-left: 0;
  }
  
  .yt-videos-grid {
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 12px;
  }
}

@media (max-width: 480px) {
  .yt-channel-header {
    padding: 16px;
    gap: 16px;
  }
  
  .yt-channel-avatar {
    width: 60px;
    height: 60px;
  }
  
  .yt-channel-info h2 {
    font-size: 1.25rem;
  }
  
  .yt-videos-grid {
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 10px;
  }
  
  .yt-video-title {
    font-size: 0.9rem;
  }
}
</style>

<div class="yt-channel-widget">
  <!-- Header with channel info -->
  <div class="yt-channel-header">
    <!-- Optional: Brand logo (uncomment and set src to display) -->
    <!-- <img class="yt-channel-logo" src="your-logo-url.png" alt="Brand Logo"> -->
    
    <img class="yt-channel-avatar" id="yt-channel-avatar" src="https://storage.googleapis.com/msgsndr/9Iv8kFcMiUgScXzMPv23/media/6984b3c50a7fd15b1977747c.png" alt="Channel Avatar">
    <div class="yt-channel-info">
      <h2 id="yt-channel-name">Loading...</h2>
      <p id="yt-channel-subscribers">Youtube</p>
    </div>
    <a class="yt-channel-subscribe" id="yt-subscribe-btn" href="#" target="_blank">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 5v14M5 12h14"/>
      </svg>
      Subscribe
    </a>
  </div>

  <!-- Videos grid -->
  <div class="yt-videos-grid" id="yt-videos-grid">
    <div class="yt-loading">Loading videos...</div>
  </div>
</div>

<script>
// Configuration - UPDATE THESE WITH YOUR VALUES
const YT_CHANNEL_CONFIG = {
  channelId: 'UCW9z3OOspfU0IFxlcVySy6w',      // Change to your channel ID
  apiBaseUrl: 'https://cms.carolinapanorama.org/api/public/youtube'
};

let videoData = [];

function formatViewCount(count) {
  if (count >= 1000000) {
    return (count / 1000000).toFixed(1) + 'M';
  } else if (count >= 1000) {
    return (count / 1000).toFixed(1) + 'K';
  }
  return count.toString();
}

async function fetchChannelInfo() {
  try {
    // Fetch channel metadata from YouTube
    // Note: This requires the YouTube API key and might need additional setup
    // For now, we'll use the public data from the video fetch
    
    const params = new URLSearchParams({
      channel_id: YT_CHANNEL_CONFIG.channelId,
      max_results: 8, // Limit to 8 videos for the grid
      include_stats: 'true'  // Request view counts for this widget
    });

    const response = await fetch(`${YT_CHANNEL_CONFIG.apiBaseUrl}?${params}`);
    const result = await response.json();

    if (result.success) {
      videoData = result.data;
      renderChannelHeader(result.name);
      renderVideosGrid();
    } else {
      showError(result.error || 'Failed to load videos');
    }
  } catch (error) {
    console.error('Error fetching videos:', error);
    showError('Error loading videos. Please try again later.');
  }
}

function renderChannelHeader(channelNameText) {
  const channelName = document.getElementById('yt-channel-name');
  const subscribBtn = document.getElementById('yt-subscribe-btn');
  
  // Set channel link
  subscribBtn.href = `https://www.youtube.com/channel/${YT_CHANNEL_CONFIG.channelId}?sub_confirmation=1`;
  
  // Update channel name
  channelName.textContent = channelNameText;
}

function renderVideosGrid() {
  const grid = document.getElementById('yt-videos-grid');
  grid.innerHTML = '';

  if (videoData.length === 0) {
    grid.innerHTML = '<div class="yt-error">No videos found.</div>';
    return;
  }

  videoData.forEach((video) => {
    const card = document.createElement('a');
    card.className = 'yt-video-card';
    card.href = video.url;
    card.target = '_blank';
    card.rel = 'noopener noreferrer';
    
    // Parse published date for relative time
    const pubDate = new Date(video.published_at);
    const now = new Date();
    const diffDays = Math.floor((now - pubDate) / (1000 * 60 * 60 * 24));
    let timeAgo = '';
    
    if (diffDays === 0) {
      timeAgo = 'Today';
    } else if (diffDays === 1) {
      timeAgo = 'Yesterday';
    } else if (diffDays < 7) {
      timeAgo = `${diffDays} days ago`;
    } else if (diffDays < 30) {
      const weeks = Math.floor(diffDays / 7);
      timeAgo = `${weeks} ${weeks === 1 ? 'week' : 'weeks'} ago`;
    } else if (diffDays < 365) {
      const months = Math.floor(diffDays / 30);
      timeAgo = `${months} ${months === 1 ? 'month' : 'months'} ago`;
    } else {
      const years = Math.floor(diffDays / 365);
      timeAgo = `${years} ${years === 1 ? 'year' : 'years'} ago`;
    }
    
    card.innerHTML = `
      <div class="yt-video-thumbnail">
        <img src="${video.thumbnail}" alt="${video.title}" loading="lazy">
        <div class="yt-video-duration">•••</div>
      </div>
      <div class="yt-video-info">
        <h3 class="yt-video-title">${video.title}</h3>
        <div class="yt-video-meta">
          <span class="yt-video-views">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 5C6 5 2 12 2 12s4 7 10 7 10-7 10-7-4-7-10-7z"/>
              <circle cx="12" cy="12" r="3"/>
            </svg>
            ${formatViewCount(video.view_count)}
          </span>
          <span>${timeAgo}</span>
        </div>
      </div>
    `;
    
    grid.appendChild(card);
  });
}

function showError(message) {
  const grid = document.getElementById('yt-videos-grid');
  grid.innerHTML = `<div class="yt-error">${message}</div>`;
}

// Fetch data on load
fetchChannelInfo();
</script>
